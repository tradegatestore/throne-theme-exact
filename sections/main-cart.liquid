{{ 'section-cart.css' | asset_url | stylesheet_tag }}
{{ 'component-cart.css' | asset_url | stylesheet_tag }}
{{ 'component-cart-items.css' | asset_url | stylesheet_tag }}
{{ 'component-totals.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
{%- endstyle -%}

<cart-items class="page-width{% if cart == empty %} is-empty{% endif %}">
  <div class="title-wrapper-with-link">
    <h1 class="title title--primary">{{ 'sections.cart.title' | t }}</h1>
    <a href="{{ routes.all_products_collection_url }}" class="underlined-link">{{ 'general.continue_shopping' | t }}</a>
  </div>

  <div class="cart__warnings">
    <h1 class="cart__empty-text">{{ 'sections.cart.empty' | t }}</h1>
    <a href="{{ routes.all_products_collection_url }}" class="button">
      {{ 'general.continue_shopping' | t }}
    </a>
  </div>

  <form action="{{ routes.cart_url }}" class="cart__contents critical-hidden" method="post" id="cart">
    <div class="cart__items" id="main-cart-items">
      <table class="cart-items">
        <thead>
          <tr>
            <th class="caption-with-letter-spacing" colspan="2" scope="col">{{ 'sections.cart.headings.product' | t }}</th>
            <th class="medium-hide large-up-hide right caption-with-letter-spacing" colspan="1" scope="col">{{ 'sections.cart.headings.total' | t }}</th>
            <th class="cart-items__heading--wide small-hide caption-with-letter-spacing" colspan="1" scope="col">{{ 'sections.cart.headings.quantity' | t }}</th>
            <th class="small-hide right caption-with-letter-spacing" colspan="1" scope="col">{{ 'sections.cart.headings.total' | t }}</th>
          </tr>
        </thead>
        <tbody>
          {%- for item in cart.items -%}
            <tr class="cart-item" id="CartItem-{{ item.index | plus: 1 }}">
              <td class="cart-item__media">
                {%- if item.image -%}
                  <a href="{{ item.url }}" class="cart-item__link" aria-hidden="true" tabindex="-1">
                    <img src="{{ item.image | image_url: width: 300 }}" class="cart-item__image" alt="{{ item.image.alt | escape }}" loading="lazy" width="150" height="{{ 150 | divided_by: item.image.aspect_ratio | ceil }}">
                  </a>
                {%- endif -%}
              </td>

              <td class="cart-item__details">
                <a href="{{ item.url }}" class="cart-item__name h4 break">{{ item.product.title | escape }}</a>
                {%- if item.product.has_only_default_variant == false or item.properties.size != 0 -%}
                  <dl>
                    {%- for option in item.options_with_values -%}
                      <div class="product-option">
                        <dt>{{ option.name }}: </dt>
                        <dd>{{ option.value }}</dd>
                      </div>
                    {%- endfor -%}
                  </dl>
                {%- endif -%}
                <p class="product-option">{{ item.selling_plan_allocation.selling_plan.name }}</p>

                <ul class="discounts list-unstyled" role="list" aria-label="{{ 'customer.order.discount' | t }}">
                  {%- for discount in item.line_level_discount_allocations -%}
                    <li class="discounts__discount">
                      {%- render 'icon-discount' -%}
                      {{ discount.discount_application.title }}
                    </li>
                  {%- endfor -%}
                </ul>
              </td>

              <td class="cart-item__totals right medium-hide large-up-hide">
                <div class="loading-overlay hidden">
                  <div class="loading-overlay__spinner">
                    <svg aria-hidden="true" focusable="false" class="spinner" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
                      <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                    </svg>
                  </div>
                </div>
                <div class="cart-item__price-wrapper">
                  {%- if item.original_line_price != item.final_line_price -%}
                    <dl class="cart-item__discounted-prices">
                      <dt class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</dt>
                      <dd><s class="cart-item__old-price price price--end">{{ item.original_line_price | money }}</s></dd>
                      <dt class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</dt>
                      <dd class="price price--end">{{ item.final_line_price | money }}</dd>
                    </dl>
                  {%- else -%}
                    <span class="price price--end">{{ item.original_line_price | money }}</span>
                  {%- endif -%}
                </div>
              </td>

              <td class="cart-item__quantity">
                <quantity-input class="quantity cart-quantity">
                  <button class="quantity__button no-js-hidden" name="minus" type="button">
                    <span class="visually-hidden">{{ 'products.product.quantity.decrease' | t: product: item.product.title | escape }}</span>
                    {% render 'icon-minus' %}
                  </button>
                  <input class="quantity__input" type="number" name="updates[]" value="{{ item.quantity }}" min="0" aria-label="{{ 'products.product.quantity.input_label' | t: product: item.product.title | escape }}" id="Quantity-{{ item.index | plus: 1 }}" data-index="{{ item.index | plus: 1 }}">
                  <button class="quantity__button no-js-hidden" name="plus" type="button">
                    <span class="visually-hidden">{{ 'products.product.quantity.increase' | t: product: item.product.title | escape }}</span>
                    {% render 'icon-plus' %}
                  </button>
                </quantity-input>
                <cart-remove-button id="Remove-{{ item.index | plus: 1 }}" data-index="{{ item.index | plus: 1 }}">
                  <a href="{{ item.url_to_remove }}" class="button button--tertiary" aria-label="{{ 'sections.cart.remove_title' | t: title: item.title }}">
                    {% render 'icon-remove' %}
                  </a>
                </cart-remove-button>
              </td>

              <td class="cart-item__totals right small-hide">
                <div class="loading-overlay hidden"></div>
                <div class="cart-item__price-wrapper">
                  {%- if item.original_line_price != item.final_line_price -%}
                    <dl class="cart-item__discounted-prices">
                      <dt class="visually-hidden">{{ 'products.product.price.regular_price' | t }}</dt>
                      <dd><s class="cart-item__old-price price price--end">{{ item.original_line_price | money }}</s></dd>
                      <dt class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</dt>
                      <dd class="price price--end">{{ item.final_line_price | money }}</dd>
                    </dl>
                  {%- else -%}
                    <span class="price price--end">{{ item.original_line_price | money }}</span>
                  {%- endif -%}
                </div>
              </td>
            </tr>
          {%- endfor -%}
        </tbody>
      </table>
    </div>
  </form>

  <div class="cart__footer" id="main-cart-footer">
    {%- if section.settings.show_cart_note -%}
      <cart-note class="cart__note field">
        <label for="Cart-note">{{ 'sections.cart.note' | t }}</label>
        <textarea class="text-area field__input" name="note" id="Cart-note" placeholder="{{ 'sections.cart.note' | t }}">{{ cart.note }}</textarea>
      </cart-note>
    {%- endif -%}

    <div class="cart__blocks">
      <div class="totals">
        <h2 class="totals__subtotal">{{ 'sections.cart.subtotal' | t }}</h2>
        <p class="totals__subtotal-value">{{ cart.total_price | money_with_currency }}</p>
      </div>

      <div>
        <p class="cart__tax-note">{{ 'sections.cart.taxes_and_shipping_policy_at_checkout_html' | t }}</p>
      </div>

      <div class="cart__ctas">
        <noscript>
          <button type="submit" class="cart__update-button button button--secondary" form="cart">{{ 'sections.cart.update' | t }}</button>
        </noscript>
        <button type="submit" name="checkout" class="cart__checkout-button button" form="cart" {% if cart == empty %}disabled{% endif %}>
          {{ 'sections.cart.checkout' | t }}
        </button>
      </div>
    </div>
  </div>
</cart-items>

{% schema %}
{
  "name": "t:sections.main-cart.name",
  "tag": "section",
  "class": "section section-{{ section.id }}-padding",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "t:sections.main-cart.settings.show_vendor.label"
    },
    {
      "type": "checkbox",
      "id": "show_cart_note",
      "default": false,
      "label": "t:sections.main-cart.settings.show_cart_note.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
